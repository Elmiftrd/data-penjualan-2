Tampilkan semua data dari tabel `pelanggan`
select * from pelanggan 

Tampilkan `nama_produk` dan `harga` dari tabel `produk` yang harganya di bawah Rp 500.000.
select nama_produk,harga from produk
where harga<500000

Tampilkan `nama_pelanggan` dan `email` untuk semua pelanggan yang berasal dari kota 'Jakarta'.
select nama_pelanggan,email FROM pelanggan
where kota='Jakarta'

Tampilkan `id_pesanan` dan `tanggal_pesanan` untuk semua pesanan yang terjadi pada bulan Juli 2025. Urutkan hasilnya dari tanggal yang paling baru.
select id_pesanan, tanggal_pesanan from pemesanan 
where month(tanggal_pesanan)=7
and year(tanggal_pesanan)=2025
order by tanggal_pesanan desc

Tampilkan semua informasi produk yang termasuk dalam kategori 'Buku'.
select * from produk
join kategori on (produk.id_kategori=kategori.id_kategori)
where kategori.nama_kategori='buku'

Tampilkan daftar `id_pesanan`, `tanggal_pesanan`, dan `nama_pelanggan` yang melakukan pesanan tersebut.
select pemesanan.id_pesanan, pemesanan.tanggal_pesanan, pelanggan.nama_pelanggan 
from pemesanan join pelanggan on (pemesanan.id_pelanggan=pelanggan.id_pelanggan)

Tampilkan `id_pesanan`, `nama_produk`, `jumlah`, dan `harga_saat_transaksi` untuk semua item yang ada di `detail_pesanan`.
select detail_pemesanan.id_pesanan, produk.nama_produk, detail_pemesanan.jumlah, detail_pemesanan.harga_saat_transaksi 
from detail_pemesanan join produk on (detail_pemesanan.id_produk=produk.id_produk)

Hitung dan tampilkan jumlah total produk untuk setiap `nama_kategori`. 
Hasil harus menampilkan `nama_kategori` dan `jumlah_produk`.
select kategori.nama_kategori, count(produk.id_produk) as 'jumlah_produk'
from kategori join produk on (kategori.id_kategori=produk.id_kategori)
group by kategori.nama_kategori 


Hitung total uang yang telah dibelanjakan oleh setiap pelanggan. Tampilkan `nama_pelanggan` dan `total_belanja`. 
(Asumsi: total belanja dihitung dari `jumlah * harga_saat_transaksi`).
select pelanggan.nama_pelanggan, sum(detail_pemesanan.harga_saat_transaksi) as 'total belanja'
from pelanggan join pemesanan on (pelanggan.id_pelanggan=pemesanan.id_pelanggan) 
join detail_pemesanan on (pemesanan.id_pesanan=detail_pemesanan.id_pesanan)
group by pelanggan.nama_pelanggan

Tampilkan nama-nama pelanggan yang belum pernah melakukan pesanan sama sekali.
select nama_pelanggan from pelanggan 
where id_pelanggan not in (
select distinct id_pelanggan from pemesanan)

Temukan nama produk yang paling banyak terjual berdasarkan total `jumlah` dari semua transaksi.
SELECT produk.nama_produk, 
       SUM(detail_pemesanan.jumlah) AS total_terjual
FROM produk
JOIN detail_pemesanan 
    ON produk.id_produk = detail_pemesanan.id_produk
GROUP BY produk.nama_produk
ORDER BY total_terjual desc
limit 1;

Tampilkan `id_pesanan`, `nama_pelanggan`, dan `total_nilai_pesanan` untuk pesanan yang memiliki nilai transaksi keseluruhan tertinggi.
select detail_pemesanan.id_pesanan, pelanggan.nama_pelanggan, sum(detail_pemesanan.harga_saat_transaksi) as total_nilai_pesanan
from detail_pemesanan join pemesanan on (detail_pemesanan.id_pesanan=pemesanan.id_pesanan)
join pelanggan on (pemesanan.id_pelanggan=pelanggan.id_pelanggan) 
group by pemesanan.id_pesanan, pelanggan.nama_pelanggan
order by total_nilai_pesanan desc 
limit 1

Untuk setiap pelanggan yang pernah memesan, tampilkan `nama_pelanggan`, 
tanggal pesanan pertamanya (`pesanan_pertama`), dan tanggal pesanan terakhirnya (`pesanan_terakhir`).
select pelanggan.nama_pelanggan, min(pemesanan.tanggal_pesanan) as pesanan_pertama, 
max(pemesanan.tanggal_pesanan) as pesanan_terakhir from pelanggan join pemesanan on (pelanggan.id_pelanggan=pemesanan.id_pelanggan)
group by pelanggan.nama_pelanggan

menampilkan semua `nama_produk` yang belum pernah ada di dalam `detail_pesanan`.
select nama_produk from produk
where id_produk not in (
select distinct id_produk from detail_pemesanan)

Tampilkan `nama_pelanggan` dan rata-rata nilai per pesanan (`rata_rata_per_pesanan`). 
Hanya tampilkan pelanggan yang rata-rata nilai pesanannya di atas Rp 1.000.000.
select pelanggan.nama_pelanggan, avg(detail_pemesanan.harga_saat_transaksi) as rata_rata_per_pesanan
from detail_pemesanan join pemesanan on (detail_pemesanan.id_pesanan=pemesanan.id_pesanan)
join pelanggan on (pemesanan.id_pelanggan=pelanggan.id_pelanggan)
group by pelanggan.nama_pelanggan
having rata_rata_per_pesanan>1000000

Tampilkan 2 produk terlaris (berdasarkan total jumlah penjualan) untuk setiap kategori produk. 
Hasil harus menampilkan nama kategori, nama produk, total jumlah terjual, dan peringkatnya dalam kategori tersebut. 
(Gunakan Window Function).
SELECT nama_kategori, nama_produk, total_terjual, peringkat
FROM (
    SELECT kategori.nama_kategori,
           produk.nama_produk,
           SUM(detail_pemesanan.jumlah) AS total_terjual,
           RANK() OVER (
               PARTITION BY kategori.id_kategori
               ORDER BY SUM(detail_pemesanan.jumlah) DESC
           ) AS peringkat
    FROM kategori
    JOIN produk 
        ON kategori.id_kategori = produk.id_kategori
    JOIN detail_pemesanan 
        ON produk.id_produk = detail_pemesanan.id_produk
    GROUP BY kategori.id_kategori, kategori.nama_kategori, produk.id_produk, produk.nama_produk
) AS ranked
WHERE peringkat <= 2
ORDER BY nama_kategori, peringkat

Buat laporan yang menampilkan total nilai penjualan (bukan jumlah) untuk setiap pelanggan, dengan rincian total belanja per kategori produk dalam kolom terpisah. 
Kolom yang harus ditampilkan adalah `nama_pelanggan`, `Total_Elektronik`, `Total_Buku`, dan `Total_Pakaian`.
SELECT 
    pl.nama_pelanggan,
    SUM(CASE WHEN k.nama_kategori = 'Elektronik' THEN dp.jumlah * dp.harga_saat_transaksi ELSE 0 END) AS Total_Elektronik,
    SUM(CASE WHEN k.nama_kategori = 'Buku' THEN dp.jumlah * dp.harga_saat_transaksi ELSE 0 END) AS Total_Buku,
    SUM(CASE WHEN k.nama_kategori = 'Pakaian' THEN dp.jumlah * dp.harga_saat_transaksi ELSE 0 END) AS Total_Pakaian
FROM pelanggan pl
JOIN pemesanan pm 
    ON pl.id_pelanggan = pm.id_pelanggan
JOIN detail_pemesanan dp 
    ON pm.id_pesanan = dp.id_pesanan
JOIN produk p 
    ON dp.id_produk = p.id_produk
JOIN kategori k 
    ON p.id_kategori = k.id_kategori
GROUP BY pl.id_pelanggan, pl.nama_pelanggan
ORDER BY pl.nama_pelanggan;





